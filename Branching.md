# Proposal: Branching strategy

## Content

1. [Constant banches](#Constant-banches)
2. [Feature branches](#Feature-branches)

## Constant banches

Существует несколько постоянных веток:
1. [master](#master-branch) branch
2. [develop](#develop-branch) branch
3. [hotfix](#hotfix-branch) branch

### Master branch

Ветка `master` представляет из себя **production** версию продукта.
Весь код в этой ветке должен быть протестирован и гарантированно рабочим.
Код, находящийся в этой ветке готов к деплою, или уже задеплоен.
Код в эту ветку может попасть только из ветки `develop` или `hotfix`.

### Develop branch

Ветка `develop` выступает в роли места для интеграци всех изменений.
Разработчики будут мерджить свои изменения в ветку `develop`.
В тот момент, когда в ветке `develop` набирается достаточно изменений - выкатывается новый релиз в ветку `master`.

### Hotfix branch

Ветка `hotfix` позволяет сократить задержки между выявлением бага и деплоем его фикса.
В случае выявления бага на *production*-версии приложения, баг фиксится в ветке `hotfix`.
После чего фикс заливается в ветку `master` и `develop`.
**Note**: Существование данной ветки пока под вопросом. Скорее всего данная ветка будет отброшена за ненадобностью.

## Feature branches

1. [Boards integration](#Boards-integration)
2. [Before PR](#Before-PR)
3. [During and after PR](#During-and-after-PR)

### Boards integration

Для каждой отдельной задачи создаётся тикет на доске разработки (на данный момент основным кондидатом на роль доски ялвяется [Trello](https://trello.com/en)).
Как только разработчик выбирает тикет и переносит его в секцию `In development` (название секции может в будущем отличаться) он также создаёт ветку.
Если тикет называется `MUI-745`, то ветка должна называться `feature/MUI-745` (стратегия именования веток пока не утверждена и может измениться в будущем).
`feature` ветка создаётся на основе ветки `develop` и мёрджится обратно в `develop`.

### Before PR

Пока разработчик работаед над фичей, его ветка может меняться так, как разработчику угодно (можно форспушить в свою ветку).
Сразу перед созданием `Pull Request`'а ветка должна быть приведена в адекватный вид:
1. Понятные, описательные и нелживые названия коммитов
2. Небольшое количество коммитов (если ситуация позволяет, то только 1)
3. Код отформатирован и проверен на работоспособность, убраны все неиспользующиеся элементы
4. Ветка должна быть актуальна (должна базироваться на самом свежем `develop` на момент создания PR)

### During and after PR

После открытия `Pull Request`'а ветка перестаёт быть локальной, следовательно, история ветки не должна быть изменена (форс пушить нельзя).
При необходимости внесения изменений в ветку после открытия `Pull Request`'а, разработчик создаёт соответствующий коммит.
Каждый подобный коммит должен закрывать 1+ спорную ситуацию.
После аппрува `Pull Request`'а, ветка мёрджится (сквошем) в `develop` и удаляется.
После мерджа в ветку коммитить **нельзя**.
